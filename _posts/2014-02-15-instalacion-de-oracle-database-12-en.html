---
layout: post
title: Instalación de Oracle Database 12 en Oracle Linux 6
date: '2014-02-15T15:45:00.001+01:00'
author: Pere Vilas
tags:
- oracle
modified_time: '2014-02-25T16:36:55.588+01:00'
blogger_id: tag:blogger.com,1999:blog-9191328551308072706.post-5218557553675626788
blogger_orig_url: http://www.pvilas.com/2014/02/instalacion-de-oracle-database-12-en.html
---

<b>Instalación del entorno gráfico</b><br />Bajar el Oracle Linux 6 de oracle.com y arrancar. Como el instalador es gráfico, tenemos que instalar un escritorio obligatoriamente. Puede ser gnome o KDE.<br /><br />Si estas instalando en entorno virtual, puedes usar dos CDs, uno con el disco de boot y otro con el sistema completo.<br /><br />Cuando nos pida seleccionar elementos, escojemos Internet-&gt;Navegador web y &nbsp;en Escritorio tenemos que seleccionar X Windows, Escritorio y todo lo relacionado con gnome.<br /><b><br /></b><b>Nombre de máquina y configuración de red</b><br />Una posibilidad es dbserver.nombre_empresa.com<br />En configuración de red sólo tenemos que activar la opción "Conectar la tarjeta al inicio del sistema".<br /><br /><b>Espacio en disco y creación de particiones</b><br />Dejar un mínimo de 40Gb de disco y 2Gb de RAM.<br /><br />En el asistente debemos seleccionar "Crear las particiones manualmente". Creamos una partición primaria en ext4 y otra de swap. Seleccionar en cada caso las opciones. Primero creamos la partición primaria, le ponemos el tamaño y la damos como activa. Seguidamente creamos la partición de swap con el File System "Swap" y le damos "ocupar todo el espacio disponible".<br /><br />Tener en cuenta que el espacio de swap debe ser 1,5 veces el de la memoria RAM. Por lo tanto, nos quedará<br /><br />partición primaria: Tamaño_disco - (1,5 * RAM)<br />swap: todo lo que quede<br /><br />Para crear la partición primaria: Crear-&gt;Partición estándar<br />Punto de montaje: /<br />Sistema de archivos ext4<br />Tamaño: (mínimo 40000MB)<br />Tamaño fijo<br />Forzar partición primaria<br /><br /><br />Para el área de swap:<br />Crear-&gt;Partición estándar<br />Sistema de archivos sqap<br />Completar hasta el máximo aceptable<br /><br /><br /><b>Usuario</b><br />Cuando nos pida el nombre de usuario darle el nombre "oracle".<br /><br />Terminar el asistente y hacer reboot.<br /><br /><b>Entrar en el entorno gráfico como usuario oracle.</b><br /><br /><br />Primero tenemos que configurar el entorno para que cumpla con las especificaciones de oracle, tenemos que buscar el fichero de preinstalación adecuado a nuestra versión, en este momento es<br /><br /><span style="font-family: inherit;"><i><span style="background-color: white; color: #444444; font-weight: bold; line-height: 16.1200008392334px;">oracle</span><span style="background-color: white; color: #444444; line-height: 16.1200008392334px;">-rdbms-server-</span><span style="background-color: white; color: #444444; font-weight: bold; line-height: 16.1200008392334px;">12cR1</span><span style="background-color: white; color: #444444; line-height: 16.1200008392334px;">-</span><span style="background-color: white; color: #444444; font-weight: bold; line-height: 16.1200008392334px;">preinstall</span></i></span><br /><span style="background-color: white; color: #444444; font-family: arial, sans-serif; font-size: x-small; font-weight: bold; line-height: 16.1200008392334px;"><br /></span>Abrir terminal y hacer<br /><br /><span style="font-family: Courier New, Courier, monospace;">su</span><br /><span style="font-family: Courier New, Courier, monospace;">cd /etc/yum.repos.d/</span><br /><span style="font-family: Courier New, Courier, monospace;">wget http://public-yum.oracle.com/public-yum-ol6.repo</span><br /><span style="font-family: Courier New, Courier, monospace;">yum install <span style="background-color: white; color: #444444; line-height: 16.1200008392334px;">oracle</span><span style="background-color: white; color: #444444; line-height: 16.1200008392334px;">-rdbms-server-</span><span style="background-color: white; color: #444444; line-height: 16.1200008392334px;">12cR1</span><span style="background-color: white; color: #444444; line-height: 16.1200008392334px;">-</span><span style="background-color: white; color: #444444; line-height: 16.1200008392334px;">preinstall</span></span><br /><span style="font-family: Courier New, Courier, monospace;">yum update</span><br /><br />[ --- Snapshot --- ]<br />Hacer reboot<br /><br />Cuando volvamos a abrir sesión, editar el la configuración de selinux para bajar la protección<br /><br /><span style="font-family: Courier New, Courier, monospace;">su</span><br /><span style="font-family: Courier New, Courier, monospace;">vi /etc/selinux/config</span><br /><span style="font-family: Courier New, Courier, monospace;">cambiar la linea SELINUX=enforcing por SELINUX=permissive</span><br /><br /><br />Con el firefox, entrar en la página web de Oracle y bajar los dos ficheros zip de Oracle Database 12c<br /><br /><br /><b>Crear la estructura de directorios</b><br /><br /><span style="font-family: Courier New, Courier, monospace;">su</span><br /><span style="font-family: Courier New, Courier, monospace;">cd /</span><br /><span style="font-family: Courier New, Courier, monospace;">mkdir -p /u01/app/oracle/product/12c/db_1</span><br /><br />Donde "oracle" es el nombre de usuario y por tanto será el oracle path de este usuario.<br /><br />Damos propiedad al grupo oinstall.<br /><br /><span style="font-family: Courier New, Courier, monospace;">chown -R oracle:oinstall /u01</span><br /><span style="font-family: Courier New, Courier, monospace;">chmod -R 775 /u01</span><br /><br />Salimos de su<br /><br /><span style="font-family: Courier New, Courier, monospace;">exit</span><br /><br />Editamos el profile del usuario oracle para que incluya el path<br /><br /><span style="font-family: Courier New, Courier, monospace;">cd /home/oracle</span><br /><span style="font-family: Courier New, Courier, monospace;">vi .bash_profile</span><br /><br />Y añadimos:<br /><br /><span style="font-family: Courier New, Courier, monospace;">ORACLE_HOSTNAME=dbserver.empresa.com; export ORACLE_HOSTNAME</span><br /><span style="font-family: Courier New, Courier, monospace;">ORACLE_UNQNAME=orcl; export ORACLE_UNQNAME</span><br /><span style="font-family: Courier New, Courier, monospace;">ORACLE_BASE=/u01/app/oracle; export ORACLE_BASE</span><br /><span style="font-family: Courier New, Courier, monospace;">ORACLE_HOME=$ORACLE_BASE/product/12c/db_1; export ORACLE_HOME</span><br /><span style="font-family: Courier New, Courier, monospace;">ORACLE_SID=orcl; export ORACLE_SID</span><br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">PATH=$ORACLE_HOME/bin:$PATH; export PATH</span><br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">LD_LIBRARY=$ORACLE_HOME/lib:/lib:/usr/lib; export LD_LIBRARY</span><br /><span style="font-family: Courier New, Courier, monospace;">CLASSPATH=$ORACLE_HOME/jlib:$ORACLE_HOME/rdbms/jlib; export CLASSPATH</span><br /><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">Guardamos y recargamos</span><br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">. .bash_profile</span><br /><br />Vamos al directorio de descargas y unzipeamos<br /><br /><span style="font-family: Courier New, Courier, monospace;">cd Descargas</span><br /><span style="font-family: Courier New, Courier, monospace;">unzip *.zip</span><br /><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">Vamos al directorio database y arrancamos la instalación (sin ser root)</span><br /><span style="font-family: inherit;"><br /></span><span style="font-family: Courier New, Courier, monospace;">cd database</span><br /><span style="font-family: Courier New, Courier, monospace;">./runInstaller</span><br /><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">Se arranca el instalador gráfico Oracle Universal Installer.&nbsp;</span><span style="font-family: inherit;">Introducimos los datos.</span><br /><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">Antes de instalar podemos guardar el archivo de respuesta, que nos puede servir en el futuro como referencia de la instalación.</span><br /><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">Cuando el instalador termine nos pedirá que ejecutemos unos scripts como root.</span><br /><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">Para comprobar la instalación abrimos una terminal y hacemos</span><br /><span style="font-family: inherit;"><br /></span><span style="font-family: Courier New, Courier, monospace;">sqlplus / as sysdba</span><br /><span style="font-family: Courier New, Courier, monospace;">startup;</span><br /><span style="font-family: Courier New, Courier, monospace;">select sysdate from dual;</span><br /><br /><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">probar el manager accediendo a&nbsp;</span><br /><span style="font-family: inherit;"><br /></span><span style="font-family: Courier New, Courier, monospace;">https://localhost:1158/em</span><br /><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">Logear como SYS y connect as SYSDBA, comprobar que la instancia esté levantada.</span><br /><br />Si tenemos problemas con el listener.ora o el tnsnames.ora, estos apuntes pueden ayudar:<br /><br />1) Comprobar el nombre de la base de datos<br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">select name, value from v$parameter where name='db_name';</span><br /><br />2) comprobar el nombre de la instancia<br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">select instance_name, host_name from v$instance;</span><br /><br />Con estos datos, en el tnsnames.ora, comprobamos el nombre del servicio:<br /><br /><span style="font-family: Courier New, Courier, monospace;"><instance_name>=</instance_name></span><br /><span style="font-family: Courier New, Courier, monospace;">(DESCRIPTION =</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; (ADDRESS=</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; (PROTOCOL = TCP)</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; (HOST = <host_name>)</host_name></span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp;(PORT = 1521))</span><br /><span style="font-family: Courier New, Courier, monospace;">)</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp;(CONNECT_DATA =</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp;(SERVICE_NAME=<instance_name>)</instance_name></span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp;)</span><br /><span style="font-family: Courier New, Courier, monospace;">)</span><br /><br />Y en el listener.ora:<br /><br /><span style="font-family: Courier New, Courier, monospace;">SID_LIST_LISTENER =&nbsp;</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; (SID_LIST =&nbsp;</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; (SID_DESC =</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; (SID_NAME = <instance_name>)</instance_name></span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; (ORACLE_HOME = /u01/app/oracle/product/XXX/db_1)</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp;)</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp;)</span><br /><span style="font-family: Courier New, Courier, monospace;">)</span><br /><br /><br />Para hacer las comprobaciones, podemos usar los comandos:<br /><br /><span style="font-family: Courier New, Courier, monospace;">lsnrctl stat</span><br /><span style="font-family: Courier New, Courier, monospace;">lsnrctl start</span><br /><div><span style="font-family: Courier New, Courier, monospace;">lsnrctl stop</span></div><div><br /></div><br /><span style="font-family: inherit;">Finalmente, para hacer el startup automático, editamos /etc/oratab y ponemos Y en el último caracter.</span><span style="font-family: inherit;">&nbsp;&nbsp;</span><span style="font-family: inherit;">Seguir&nbsp;</span><a href="http://www.oracle-base.com/articles/linux/automating-database-startup-and-shutdown-on-linux.php" style="font-family: inherit;" target="_blank">este</a><span style="font-family: inherit;">&nbsp;tutorial, o&nbsp;</span><a href="http://docs.oracle.com/cd/B28359_01/server.111/b32009/strt_stp.htm#UNXAR173" style="font-family: inherit;" target="_blank">este</a><span style="font-family: inherit;">&nbsp;para terminar de configurar el auto start/stop.</span><br /><div><span style="font-family: inherit;"><br /></span></div><div><span style="font-family: inherit;">Para crear el primer usuario y otorgarle permisos podemos usar algo parecido a <a href="http://www.pvilas.com/2013/12/oracle-crear-rol-y-asignarselo-usuario.html">esto</a>.</span></div><br /><span style="font-family: inherit;">En caso necesario, abrir el puerto 1521 en el cortafuegos.</span><br /><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">[ --- Snapshot --- ]</span><br /><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">Referencias:</span><br /><span style="font-size: x-small;"><span style="font-family: inherit;">Series de DBASoup&nbsp;</span>http://www.youtube.com/watch?v=enzODUcYERI</span><br /><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><br /><br /><br />