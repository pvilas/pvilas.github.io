---
layout: post
title: Construcción de objetos en javascript
date: '2014-09-09T02:00:00.001+02:00'
author: Pere Vilas
tags:
- javascript
modified_time: '2014-09-09T11:32:22.227+02:00'
blogger_id: tag:blogger.com,1999:blog-9191328551308072706.post-347742884782691665
blogger_orig_url: http://www.pvilas.com/2014/09/construccion-de-objetos-en-javascript.html
---

<h1 id="construcción-de-objetos">Construcción de objetos</h1> <p>Podemos construir un objeto con</p>   <pre class="prettyprint"><code class=" hljs css"><span class="hljs-tag">var</span> <span class="hljs-tag">myPoint</span><span class="hljs-rules">{ <span class="hljs-rule"><span class="hljs-attribute">x</span>:<span class="hljs-value"><span class="hljs-number">0</span></span></span>; <span class="hljs-rule"><span class="hljs-attribute">y</span>:<span class="hljs-value"><span class="hljs-number">0</span></span></span></span>};</code></pre> <p>Pero, por supuesto, esto sólo nos daría un copia del objeto. ¿Cómo creamos más de una instancia?, pues usando un object factory:</p>   <pre class="prettyprint"><code class=" hljs javascript">Point=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span><br />    <span class="hljs-keyword">return</span> {x:<span class="hljs-number">0</span>; y:<span class="hljs-number">0</span>};<br />};<br /><span class="hljs-keyword">var</span> myPoint= Point();</code></pre> <p>Sin embargo, así como el objeto va creciendo y se va sofisticando, es complicado de mantener; Una mejor alternativa es usar:</p>   <pre class="prettyprint"><code class=" hljs javascript">Point=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span><br />    <span class="hljs-keyword">var</span> obj={};<br />    obj.x=x;<br />    obj.y=y;<br />    <span class="hljs-keyword">return</span> obj;<br />};<br /><span class="hljs-keyword">var</span> myPoint= Point(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>);</code></pre>   <h3 id="acceso-a-los-miembros-de-un-objeto">Acceso a los miembros de un objeto</h3> <p>Recordamos cómo dar acceso público o privado a los miembros de un objeto, aunque sabemos que en javascript no existen <strong>métodos</strong>, sólo referencias a objetos (tales como el objeto Function).</p>   <pre class="prettyprint"><code class=" hljs javascript">Point=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(x,y)</span> {</span><br />    <span class="hljs-keyword">var</span> obj={};<br /><br />    <span class="hljs-comment">// variables públicas</span><br />    obj.x=x;<br />    obj.y=y;<br /><br />    <span class="hljs-comment">// variable privada</span><br />    <span class="hljs-keyword">var</span> privada = <span class="hljs-number">10</span>;<br /><br />    <span class="hljs-comment">// este "método" es privado</span><br />    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resta</span><span class="hljs-params">()</span> {</span><br />        <span class="hljs-keyword">return</span> obj.x-obj.y;<br />    };<br /><br />    <span class="hljs-comment">// este "método" es público</span><br />    obj.add=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span><br />        <span class="hljs-keyword">return</span> obj.x+obj.y;<br />    };<br /><br />    <span class="hljs-keyword">return</span> obj;<br />};<br /><span class="hljs-keyword">var</span> myPoint=Point(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>);<br />console.log(myPoint.add()); <span class="hljs-comment">// 3</span><br />myPoint.x=<span class="hljs-number">4</span>;<br />console.log(myPoint.add()); <span class="hljs-comment">// 6</span></code></pre> <ul><li><strong>add</strong> es público por que se devuelve con el objeto. </li><li>obj no existe fuera de myPoint.</li><li>obj es una variable privada para la instancia de objeto que hemos creado.</li><li>cualquier variable local declarada dentro del factory es tratada como privada.</li></ul>   <h2 id="métodos-de-construcción">Métodos de construcción</h2>   <h3 id="diferencias-entre-new-y-var">Diferencias entre new y var</h3> <p>Los dos métodos de construcción existentes son igualmente correctos: Usando la palabra clave new o creando un object-factory, pero posteriormente haremos una precisión respecto al uso de <strong>new</strong> y <strong>this</strong>. </p>   <h4 id="new">new</h4>   <pre class="prettyprint"><code class=" hljs javascript">Point=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(x,y)</span> {</span><br />    <span class="hljs-keyword">this</span>.x=x;<br />    <span class="hljs-keyword">this</span>.y=y;<br />    <span class="hljs-keyword">this</span>.add=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span><br />        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.x+<span class="hljs-keyword">this</span>.y;<br />    };<br />    <span class="hljs-comment">// no es necesario devolver this.</span><br />};<br /><span class="hljs-keyword">var</span> myPoint=<span class="hljs-keyword">new</span> Point(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>);<br />console.log(myPoint.add()); <span class="hljs-comment">// 3</span><br />myPoint.x=<span class="hljs-number">4</span>;<br />console.log(myPoint.add()); <span class="hljs-comment">// 6</span></code></pre>   <h4 id="var">var</h4>   <pre class="prettyprint"><code class=" hljs javascript">Point=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(x,y)</span> {</span><br />    <span class="hljs-keyword">var</span> obj={};<br />    obj.x=x;<br />    obj.y=y;<br />    obj.add=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span><br />        <span class="hljs-keyword">return</span> obj.x+obj.y;<br />    };  <br />    <span class="hljs-keyword">return</span> obj;<br />};<br /><span class="hljs-keyword">var</span> myPoint=Point(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>);<br />console.log(myPoint.add()); <span class="hljs-comment">// 3</span></code></pre> <p>¿Cuál es la diferencia entre los dos?. La diferencia fundamental es que la versión con <strong>new</strong> devuelve el objeto this automáticamente. </p>   <h4 id="atención">Atención</h4> <p>Cuando nos referimos a this, estamos hablando del contexto de ejecución actual (la closure actual) dentro de una función.  </p> <blockquote>  <p><strong>this</strong> fuera de una función se refiere al objeto global <strong>this</strong>.  <br>  <strong>this</strong> dentro de una función se refiere al contexto de ejecución (la closure) actual.</p>     <h4 id="cuidado-con-las-confusiones">Cuidado con las confusiones.</h4>     <p><strong>this</strong> como objeto global fuera de una función no es lo mismo que el contexto raiz. </p></blockquote> <pre><code>x=3;<br />this.x=5;<br />console.log('x es',x,'y this.x es', this.x); <br />// x es 3 y this.x es 5<br /></code></pre> <p>Es como si al principio del programa tuviéramos el objeto llamado <strong>this</strong> instanciado de la siguiente manera:</p> <pre><code>var this={};<br /></code></pre> <p>y cada vez que creamos un objeto con <strong>new</strong> se nos añadiera dicha línea al principio del objeto de forma automática.</p>   <h4 id="mejor-estilo">Mejor estilo</h4> <p>Según el artículo de Ian, la versión con <strong>new</strong> <em>suena</em> mejor al programador que viene de otros lenguajes, pero la versión con variable es más javascript. </p>   <h4 id="disclaimer">Disclaimer</h4> <p>Esta entrada es resultado de apuntes tomados al vuelo leyendo la serie de artículos de javascript escrita por Ian Elliot en i-programmer. No pretende ser una traducción al español ni nada parecido, es un simple registro para mi uso personal. Debe referirse al original para su lectura.</p> <blockquote>  <p>Fuente: <a href="http://www.i-programmer.info/programming/javascript.html">i-programmer.info</a> <br>  Written with <a href="https://stackedit.io/">StackEdit</a>.</p></blockquote>